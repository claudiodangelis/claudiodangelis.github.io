<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Blogging with Jekyll using Git, Github and Amazon AWS | Claudio d’Angelis Blog</title>
<meta name="generator" content="Jekyll v3.7.2" />
<meta property="og:title" content="Blogging with Jekyll using Git, Github and Amazon AWS" />
<meta property="og:locale" content="en" />
<meta name="description" content="I’ve been using Jekyll a lot lately, I’m totally in love with it, it’s a simple, fast and brilliant Ruby tool to generate static websites and blogs. Well, this post is not really about Jekyll per se, it’s more likely about the way I use it inside my ecosystem. If you want to learn more about Jekyll, I think the official website is a good place to start from." />
<meta property="og:description" content="I’ve been using Jekyll a lot lately, I’m totally in love with it, it’s a simple, fast and brilliant Ruby tool to generate static websites and blogs. Well, this post is not really about Jekyll per se, it’s more likely about the way I use it inside my ecosystem. If you want to learn more about Jekyll, I think the official website is a good place to start from." />
<link rel="canonical" href="http://localhost:4000/web/2013/06/21/blogging-with-jekyll-using-git-github-and-amazon-aws.html" />
<meta property="og:url" content="http://localhost:4000/web/2013/06/21/blogging-with-jekyll-using-git-github-and-amazon-aws.html" />
<meta property="og:site_name" content="Claudio d’Angelis Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2013-06-21T00:00:00+02:00" />
<script type="application/ld+json">
{"dateModified":"2013-06-21T00:00:00+02:00","datePublished":"2013-06-21T00:00:00+02:00","@type":"BlogPosting","headline":"Blogging with Jekyll using Git, Github and Amazon AWS","url":"http://localhost:4000/web/2013/06/21/blogging-with-jekyll-using-git-github-and-amazon-aws.html","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/web/2013/06/21/blogging-with-jekyll-using-git-github-and-amazon-aws.html"},"description":"I’ve been using Jekyll a lot lately, I’m totally in love with it, it’s a simple, fast and brilliant Ruby tool to generate static websites and blogs. Well, this post is not really about Jekyll per se, it’s more likely about the way I use it inside my ecosystem. If you want to learn more about Jekyll, I think the official website is a good place to start from.","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="alternate" type="application/rss+xml" title="Claudio d&#39;Angelis Blog" href="/feed.xml">
  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" rel="author" href="/">Claudio d&#39;Angelis Blog</a>

    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/about/">About</a>
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <p>I’ve been using <strong>Jekyll</strong> a lot lately, I’m totally in love with it, it’s a simple,
fast and brilliant Ruby tool to generate static websites and blogs. Well,
this post is not really about Jekyll <em>per se</em>, it’s more likely about the way I use it inside my
<em>ecosystem</em>.<br />
If you want to learn more about Jekyll, I think the <a href="http://jekyllrb.com">official website</a>
is a good place to start from.</p>

<p>Ok, let’s talk about the way I use Jekyll: I build my website locally, then I push
changes with <strong>git</strong> to my Amazon <strong>AWS</strong> instance and at the same time I keep a copy
of the blog sources on <strong>Github</strong> available <a href="http://claudiodangelis.com/~/claudiodangelis">for consultation or forking</a>.
That’s it.</p>

<p>Just for completeness, Github itself has a great free hosting service for your site,
<a href="http://pages.github.com/">Github Pages</a>, that supports static sites and Jekyll blogs as well, but I’m already a (happy) AWS user
so I decided to host my site there instead of Github Pages.</p>

<p>So this is the scenario, now let’s take a look at the workflow: I push changes
both to AWS and Github, then a <em>post-receive</em>
<a href="http://git-scm.com/book/en/Customizing-Git-Git-Hooks">hook script</a> on the server
builds and publishes the Jekyll blog.</p>

<p><img src="/assets/img/posts/jekyll-aws.png" alt="Screenshot" /></p>

<p>In order to obtain such workflow, we have to:</p>

<ol>
  <li>Create a bare repository on the server</li>
  <li>Add a hook script to the bare repository</li>
  <li>Clone the repository locally</li>
  <li>Create a github repository</li>
  <li>Add github origin to the local repository</li>
  <li>Configure local repository in order to push changes to both AWS and github repositories</li>
</ol>

<!--more-->

<p><strong>Assumptions and conventions used for this tutorial:</strong></p>

<p>You need to <a href="http://git-scm.com/book/en/Getting-Started-Installing-Githttp://git-scm.com/book/en/Getting-Started-Installing-Git">have git</a>
and <a href="http://jekyllrb.com/">have jekyll</a> installed on your AWS instance.</p>

<p>We will use the following values, please change them accordingly to your actual/desired configuration:</p>

<table>
  <tbody>
    <tr>
      <td><em>AWS instance’s user</em></td>
      <td><strong>ec2-user</strong></td>
    </tr>
    <tr>
      <td><em>AWS’s key pair’s path</em></td>
      <td><strong>~/Documents/ec2-user.pem</strong></td>
    </tr>
    <tr>
      <td><em>Website domain</em></td>
      <td><strong>http://mysite.com</strong></td>
    </tr>
    <tr>
      <td><em>Blog repository’s name</em></td>
      <td><strong>mysite</strong></td>
    </tr>
    <tr>
      <td><em>Remote git bare repository</em></td>
      <td><strong>/home/ec2-user/mysite.git</strong></td>
    </tr>
    <tr>
      <td><em>Remote git non-bare repository</em></td>
      <td><strong>/home/ec2-user/mysite</strong></td>
    </tr>
    <tr>
      <td><em>Both remote and local document root</em>    </td>
      <td><strong>/var/www/html</strong></td>
    </tr>
    <tr>
      <td><em>Local repository</em></td>
      <td><strong>~/workspace/mysite</strong></td>
    </tr>
  </tbody>
</table>

<p>Source files of jekyll blog are in a <code class="highlighter-rouge">src</code> directory of the repository
(you may want to keep a README, LICENSE or something outside the sources of your blog)</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    mysite/
      .git/
      README
      LICENSE
      src/_config.yml
      src/_layouts
      src/...
</code></pre></div></div>

<p>Now we’re ready to get started , yay!</p>

<hr />

<ol>
  <li>
    <p>Connect to the AWS instance and create a bare repository, then clone it to
have a working directory.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> # you're on your local machine
 ssh-add ~/Documents/ec2-user.pem
 ssh ec2-user@mysite.com

 # you're now on your home directory of your remote AWS instance
 mkdir ~/mysite.git
 cd mysite.git
 git init --bare
 cd ..
 git clone mysite.git
</code></pre></div>    </div>

    <p>Now in your home directory you have both the bare and non-bare repository,
 respectively <strong>mysite.git</strong> and <strong>mysite</strong>.</p>
  </li>
  <li>
    <p>Add a <strong>post-receive</strong> hook script to remote bare repository.</p>

    <p>This script will pull changes from the bare repository to the non-bare repository and
 finally will build your website. You can edit the <strong>post-receive</strong> hook with <strong>nano</strong> editor.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> # you're on your remote AWS instance
 cd ~/mysite.git/hooks/
 touch post-receive
 nano post-receive
</code></pre></div>    </div>

    <p>Now set the content of <strong>post-receive</strong> script:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> unset $(git rev-parse --local-env-vars)
 cd /home/ec2-user/mysite
 git pull
 cd src
 jekyll build
</code></pre></div>    </div>
  </li>
  <li>
    <p>We’re done with the remote instance, let’s go back to the local machine and
clone the remote repository.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> # you're on your local machine
 cd ~/workspace
 ssh-add ~/Documents/ec2-user.pem
 git clone ec2-user@mysite.com:~/mysite.git
</code></pre></div>    </div>

    <p>If everything goes fine you should see this message:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Warning: You appear to have cloned an empty repository.
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a new repository on github, and be sure to <strong>leave unchecked</strong> the
“Initialize this repository with a README” flag.</p>

    <p><img src="/assets/img/posts/github-create-new-repository.png" alt="Screenshot" /></p>
  </li>
  <li>
    <p>Now we need to add the github repository as remote origin of our local repository:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> # you're on your local machine
 cd ~/workspace/mysite
 git remote add github git@github.com:your_github_username/mysite.git
</code></pre></div>    </div>

    <p>This will create a new origin named “github” for your local repository.</p>
  </li>
  <li>
    <p>Last step. We will add an extra origin to our local repository, let’s say “all”,
in order to <strong>push</strong> changes to both AWS and github repositories at the same time.<br />
 To do this, edit the <strong>.git/config</strong> file with <code class="highlighter-rouge">nano</code> editor and append these
 lines at the end of file:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> [remote "all"]
         url = ec2-user@mysite.com:~/mysite.git
         url = git@github.com:your_github_username/mysite.git
</code></pre></div>    </div>
  </li>
</ol>

<p>We’re done! Create your blog, test it, and when you’re ready you can easily push
changes to AWS and github with this command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git push -u all master
</code></pre></div></div>

<p>If everything’s gone fine, you should see an output like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Counting objects: 27, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (19/19), done.
Writing objects: 100% (19/19), 92.56 KiB | 0 bytes/s, done.
Total 19 (delta 13), reused 0 (delta 0)
. . .
remote:  15 files changed, 151 insertions(+), 0 deletions(-)
remote:  create mode 100644 src/assets/img/posts/github-create-new-repository.png
remote:  create mode 100644 src/assets/img/posts/jekyll-aws.png
remote: Configuration file: /home/ec2-user/mysite/src/_config.yml
remote:             Source: .
remote:        Destination: /var/www/html
remote:       Generating... done.
To ec2-user@emysite.com:~mysite.git
   af7c742..df6bcfc  master -&gt; master
Branch master set up to track remote branch master from all.
Counting objects: 27, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (19/19), done.
Writing objects: 100% (19/19), 92.56 KiB | 0 bytes/s, done.
Total 19 (delta 13), reused 0 (delta 0)
To https://github.com/your_github_username/mysite.git
   af7c742..df6bcfc  master -&gt; master
Branch master set up to track remote branch master from all.
</code></pre></div></div>

<hr />

<p>As usual, feedback and suggestions are always welcome. Happy blogging everybody!</p>

      </div>
    </main>

    <footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Claudio d&#39;Angelis Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">
            
              Claudio d&#39;Angelis Blog
            
            </li>
            
            <li><a class="u-email" href="mailto:claudiodangelis@gmail.com">claudiodangelis@gmail.com</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
  
  
  
  <li><a href="https://github.com/claudiodangelis"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">claudiodangelis</span></a></li>
  
  
  
  <li><a href="https://www.twitter.com/daw985"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">daw985</span></a></li>
  
  
  
</ul>

      </div>

      <div class="footer-col footer-col-3">
        <p>Personal blog of Claudio d&#39;Angelis.</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
